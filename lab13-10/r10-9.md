# R10-9  Detecting Rogue-Installed PKI Certificates
## Objective
* Understand what is PKI Certificate
* Inspect Certificate Registry Entries
* Extracting Certificates

## Knowledge
* Public Key Infrastructure (PKI) is a system of processes, technologies, and policies that allows you to encrypt and sign data.
* Ensure the confidentiality, integrity, and availability of electronic transactions.
* Using asymmetric Cryptography
* PKI can work with antivirus by ensuring the integrity of the systems and data that antivirus software protect

<img width="556" height="287" alt="image" src="https://github.com/user-attachments/assets/f70f81d9-155e-4b6d-aae1-61a4cdd42a29" />

## Inspecting Certificate Registry Entries
First, open `regedit` and navigate to `HKEY_LOCAL_MACHINE\Software\Microsoft\SystemCertificates`

<img width="1200" height="651" alt="image" src="https://github.com/user-attachments/assets/e1d3df0a-3c2c-4928-b0ae-776e7f8c3d70" />

Here we can see a lot of keys, let's check a random one in `CA` key

<img width="1166" height="626" alt="image" src="https://github.com/user-attachments/assets/23000019-eeb0-4ba7-adf2-ebd7ad05d3f2" />

## Extracting Certificates
Using [this script](certdump.pl) I Provided in perl, we can check using this command 
```
perl certdump.pl -a SOFTWARE
```
<img width="817" height="821" alt="image" src="https://github.com/user-attachments/assets/c11c884e-a3a3-4fb8-81a4-4eee6bcb3fa7" />

<img width="907" height="830" alt="image" src="https://github.com/user-attachments/assets/7f83d564-b919-4e7c-8b52-a3bcec68fb70" />


## Reference
* [What is PKI?](https://www.digicert.com/what-is-pki)
* [Public Key Infrastructure 101](https://www.idmanagement.gov/university/pki/)
